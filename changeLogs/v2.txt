GDevelop + Windsurf Codex — v2 升级提示（在现有 v1 项目上自动执行）
================================================================================
目标：在 https://github.com/eat-chestnut/game 的现有 v1 代码基础上，自动体检、修复、优化并扩展。
若发现与本提示不符的实现，直接重构覆盖。仓库根目录应包含 libs/, src/, index.html, build.config.json, skill_config.json。

【执行模式】
- 全自动执行：创建/修改/覆盖 场景、对象、事件、变量、资源。
- 每轮输出变更清单与自测结果。
- 兼容现有目录结构；不存在则新建。

----------------------------------------------------------------
一、回归与一致性检查
----------------------------------------------------------------
1. 校验场景与 External Events 是否齐全，缺则创建：MainMenu, Game, GameOver, UITheme, AutoAim, SkillSystem, WaveSystem, LootDrop, PauseSystem, Audio, QA。
2. 校验全局变量，补齐默认值。
3. 校验 UITheme 样式一致性（颜色/阴影/字体/圆角）。
4. 检查 skill_config.json 是否存在并对齐字段，否则以 v4 内置 JSON 写入并载入到 GlobalVariable(SkillConfig)。

----------------------------------------------------------------
二、Bug 修复
----------------------------------------------------------------
1. 攻速冷却：fireRate 初始 2.0s，冷却递减使用 TimeDelta；最低 0.60s。
2. 连发/散射不相乘，总伤取 max(multi_total, scatter_total)。
3. 分裂子弹 isSplitChild=true，不继承形态技能，伤害 60% 主弹，分裂冷却 30ms。
4. 穿透：每穿一次伤害 ×0.9，最低 50%；反弹：每次 ×0.85。
5. 升级时暂停，面板关闭后恢复。
6. 波次计时统一 30s，使用计时器 WaveTimer；敌速/血量/生成速递增。
7. 对象泄漏防护：敌 ≤80、分裂弹 ≤50、寿命 ≤2s。
8. 按钮点击区优化，HUD 边距按竖屏自适配。

----------------------------------------------------------------
三、功能扩展
----------------------------------------------------------------
1. 技能卡显示等级（Lv cur/max），满级从池移除。
2. QA 场景按钮：Spawn50 / LevelUpTo10 / SpreadTest，输出 FPS 与变量快照。
3. 音量设置与 Storage 持久化。
4. Loading 界面与 Web 发布配置。

----------------------------------------------------------------
四、性能优化
----------------------------------------------------------------
1. 最近敌人检测每 0.05s 执行（平方距离法）。
2. 子弹/敌人对象池复用。
3. External Events 拆分独立逻辑。

----------------------------------------------------------------
五、事件重构要点
----------------------------------------------------------------
AutoAim：读取 ShotPattern 生成子弹，写入实例变量 bullet_damage, penetration_left, rebound_left。
SkillSystem：applySkill() 按公式修改全局并调用 recalcShotPattern()。
WaveSystem/LootDrop/PauseSystem/Audio 按规范同步修复。

----------------------------------------------------------------
六、自动断言
----------------------------------------------------------------
- fireRate ≥0.60s；连发+散射取 max；分裂不再分裂；穿透/反弹衰减生效。
- 生成 50 敌人 FPS 稳定。
- 升级冻结/恢复逻辑正确。

----------------------------------------------------------------
七、输出要求
----------------------------------------------------------------
- 变更清单（新增/修改/覆盖项）
- 自测报告（FPS / fireRate / totalMultiplier）
- 若存在未完成项，下一轮自动修复。

----------------------------------------------------------------
八、参考
----------------------------------------------------------------
代码仓库：https://github.com/eat-chestnut/game
----------------------------------------------------------------
